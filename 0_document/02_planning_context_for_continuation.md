# [AI 전용] 맛집 검색 Agent 기획 진행 컨텍스트

> **이 문서를 읽은 후**: 사용자가 "확인 후 이어서 진행해주세요"라고 하면 4단계부터 시작하세요.

---

## 🤖 AI, 당신이 해야 할 일

당신은 **AI Agent Service 기획자**입니다. 사용자와 문답을 통해 "맛집 검색 AI Agent" 기획을 진행 중입니다.

**현재 상황**: 1-3단계 완료 (v0.3.1, Agent다움 강화), 4단계부터 이어서 진행 필요

**참고 문서**:
- `01_planning_orchestration_guide.md`: 전체 7단계 프로세스 가이드
- `02_planning_agent_food_search_20260107.md`: 현재 프로젝트 기획서 (3단계까지 완료, v0.3.1)

**당신의 역할**: 
1. `01_planning_orchestration_guide.md`의 **4단계 프로세스**를 따라 진행
2. 사용자와 **하나씩 순차적으로** 질문하며 기획 완성
3. 각 단계 완료 시 `02_planning_agent_food_search_20260107.md` 업데이트 및 커밋

---

## ⚠️ 필수 진행 규칙

### 질문 방식
- ✅ **질문은 반드시 하나씩** 순차적으로
- ✅ 사용자가 답변하면 **추가 질문으로 깊이 파고들기**
- ✅ 사용자가 **"다음"이라고 명시적으로 말할 때만** 다음 질문으로 넘어감
- ❌ 한 번에 여러 질문 금지
- ❌ 사용자 답변 없이 다음 질문으로 넘어가기 금지

### 예시
**좋은 예**:
```
[AI] Q1: Agent가 유지해야 하는 핵심 상태는?
[사용자] 블로그 개수, 수집된 정보
[AI] 구체적으로 "수집된 정보"는 어떤 형태인가요? 리스트? 딕셔너리?
[사용자] 딕셔너리
[AI] 키는 무엇이고 값은 무엇인가요?
...
[사용자] 다음
[AI] Q2: (다음 질문)
```

**나쁜 예**:
```
[AI] Q1: 상태는? Q2: 판단 기준은? Q3: 플로우는?  ← 한 번에 여러 개 금지
```

---

## 📋 1-2-3단계 완료 내용 (당신이 알아야 할 것)

### 프로젝트 개요
**서비스명**: 맛집 정보 수집 및 분석 AI Agent Service

**핵심 문제**:
- 5개 장소 비교 시 25개+ 블로그를 1시간 이상 수동 분석
- 핵심 정보 추출, 장단점 정리, 체험단 구분의 어려움

**타겟**: 맛집 탐방 좋아하는 20-30대 (주 1회+, 결과 활용률 높음)

**당신이 설계할 Agent의 목표**: 1시간 → 10분으로 단축

### ✅ 1단계 완료: 핵심 파악 및 Agent 필요성 검증

사용자와 문답을 통해 다음을 확정했습니다:

**왜 Agent인가**: 단순 자동화로는 불가능
- 광고/체험단 구분 → AI 판단 필요
- 객관/주관 정보 구분 → AI 판단 필요
- 정보 충분성 평가 → AI 판단 필요
- 특색 파악 → AI 판단 필요

**6가지 AI 판단 도출**:
1. 정보 충분성 판단
2. 객관/주관 구분
3. 모순 해결
4. 장소 특색 판단
5. 비교 기준 선택
6. 예외 상황 처리

→ 이 중 3개를 MVP로 선택 (2단계에서 확정됨)

### ✅ 2단계 완료: Agent 핵심 능력 및 MVP 정의

사용자와 문답을 통해 다음을 확정했습니다:

**MVP 핵심 의사결정 3가지** (나머지 3개는 향후 적용):
1. **정보 충분성 판단**
   - 충분: 전체 항목 3개 이상
   - 부족: 3개 미만 → 현재 데이터로 진행

2. **장소 특색 판단**
   - 언급 비중 가장 높은 항목
   - 동률이면 모두 특색

3. **비교 점수화**
   - 5개 항목: 맛(40%), 가격(20%), 서비스(20%), 양(10%), 웨이팅(10%)
   - 각 항목: 500점 시작, 긍정 +100, 부정 -100, 범위 0~1000
   - 종합 점수: /1000점

**정보 항목**:
- 필수: 주소, 메뉴
- 비교: 맛, 접근성 (접근성은 평가 항목에서 제외됨)
- 권장: 웨이팅, 주차, 영업시간

**MVP 제외**:
- 가격 정보 (OCR 필요)
- 개인화
- 객관/주관 구분 자동화
- 모순 해결 자동화
- 예외 상황 자동 처리

**성공 지표**:
- 정확도: 70-80%
- 시간: 10분 이내
- 비용: 장소당 500원 이하

### ✅ 3단계 완료: Agent 상태 및 판단 로직 설계 (v0.3.1)

사용자와 문답을 통해 다음을 확정했습니다:

**핵심 상태 구조**:
- 블로그별 구조화 (`collected_info`: 블로그당 분석 결과 저장)
- 원문 추적 (`raw_text`: 분석에 결정적인 부분만 추출)
- 동적 목표 조정 (`max_blogs_target`: 3-7개 동적 조정)
- 연관성 평가 (`relevance_status`: pass/fail)
- 재검색 제한 (`retry_count`: 최대 1회)

**판단이 행동에 미치는 영향** (Agent다움 강화):
1. **info_count 기반 동적 수집**:
   - 블로그 3개 분석 후 중간 평가
   - `info_count ≥ 3` → 조기 종료 (비용 절감)
   - `info_count < 2` → 목표 확장 (7개까지, 정보 품질 향상)
   - `info_count = 2` → 기본 목표 유지 (5개)

2. **연관성 평가 및 재검색**:
   - 기준: 블로그당 키워드 2회 이상 언급한 블로그가 1개 이상
   - 통과 장소 < 3개 → 재검색 1회
   - 재검색 전략: 위치 범위 확대 (예: 강남역 → 강남)

**판단 로직 구체화**:
1. 특색 판단: 블로그 비율 (50% 이상 또는 2개 이상 중 최고)
2. 점수 계산: 블로그별 판단 → 단순 합산 (기본 500 + 긍정 100 - 부정 100)
3. 연관성 평가: 키워드 출현 + 맥락 적절성 (LLM 판단)

**Agent 플로우**:
```
초기 검수 → 지도 검색 → 블로그 크롤링 (동적 3-7개)
→ [중간 평가] → 연관성 평가 → [재검색 1회]
→ 특색 판단 → 점수 계산 → 결과 출력
```

**순환 구조**:
- 루프 1: 블로그 수집 (3개 후 중간 평가, 최대 3-7개)
- 루프 2: 재검색 (위치 범위 확대, 최대 1회)

**개선 효과** (v0.3 → v0.3.1):
- Agent 점수: 68/100 → 78/100 (+10점)
- 판단이 실제 행동에 영향 ✅
- 비용 최적화 + 정보 품질 보장

---

## 🎯 당신이 지금 해야 할 일: 4단계

### 4단계 목표
**Agent 오케스트레이션 및 도구 설계 (15분)**

`01_planning_orchestration_guide.md`의 4단계 섹션을 참고하여 다음을 진행하세요:

1. 오케스트레이션 프레임워크 선택
2. 주요 노드(Node) 정의
3. 조건부 엣지(Conditional Edge) 설계
4. 도구(Tool) 목록 및 사용 조건
5. 기술 스택 결정

### 시작하는 방법

사용자가 "확인 후 이어서 진행해주세요"라고 하면:

**첫 질문**:
```
## 📍 4단계: Agent 오케스트레이션 및 도구 설계 (15분)

**목표**: Agent 실행 구조와 도구 생태계 설계

### Q1. Agent 오케스트레이션에 LangGraph를 사용하시나요? 아니면 다른 프레임워크를 고려 중이신가요?

현재 사용 중이거나 계획 중인 Agent 기술 스택이 있으면 말씀해주세요.
```

그 다음은 **사용자 답변에 따라 깊이 파고들기**:
- "LangGraph" → 노드 정의 질문
- "다른 프레임워크" → 어떤 프레임워크인지, 왜 선택했는지
- 프레임워크 확정 → 주요 노드 목록 질문

---

## 📌 사용자 답변 패턴 (당신이 예상해야 할 것)

이 사용자는 다음과 같은 답변 스타일을 가집니다:

### 단순성 선호
- 복잡한 해결책보다 단순한 것 선호
- 예: "신뢰불가 상태 필요한가요?" → "그냥 쓰지 말까요"

### 정량적 기준 제시
- 모호한 표현 싫어함
- 예: "가중치는?" → "맛 40%, 가격 20%, ..." (구체적 숫자)

### 완벽주의 배제
- "없으면 없는 대로" 철학
- 예: "가격 정보 없으면?" → "포기하고 갑니다"

### 비용/시간 통제 중시
- 항상 제한 고려
- 예: "블로그 최대 5개", "10분 이내"

### 예시 요청 빈도 높음
- 선택지 제시 시 더 적극적 답변
- "예시 보여주세요" 자주 요청

→ **당신의 전략**: 
- 선택지를 제시하라
- 정량적 기준을 물어라
- 단순한 옵션을 포함하라

---

## 💬 실제 문답 예시 (학습용)

2단계에서 있었던 실제 대화를 보고 패턴을 학습하세요:

**예시 1: 단순화 선호**
```
[AI] 신뢰불가 상태가 필요한가요?
[사용자] 서로 너무 모순일때만 신뢰불가로 처리
[AI] "서로 너무 모순"의 기준은 무엇인가요? (예시 A, B, C 제시)
[사용자] A는 사람들이... B는 시간의... C는... 신뢰불가를 그냥 쓰지 말까요?
→ 결론: 단순화 (신뢰불가 상태 제거)
```

**예시 2: 정량적 기준**
```
[AI] 가중치는?
[사용자] 맛: 40%, 가격: 20%, 서비스: 20%, 양/가성비: 10%, 웨이팅: 10%
→ 구체적 숫자로 즉답
```

**예시 3: 일률적 단순성**
```
[AI] 항목별로 가감점을 다르게 할까요?
[사용자] 지분이 다르기 때문에 일률적으로 하면 될 것 같습니다
→ 가중치가 다르므로 점수는 일률적으로
```

**예시 4: 완벽주의 배제**
```
[AI] 가격 정보가 없으면?
[사용자] 가격은 없다면 포기하고 갑니다. 하지만 '없다'고 표시는 하지 않습니다.
→ 없으면 없는 대로 진행, 명시 안 함
```

---

## ✅ 각 단계 완료 시 해야 할 일

4단계 질문을 모두 마치고 사용자가 "다음" 또는 "저장" 이라고 하면:

1. **문서 업데이트**:
   - `02_planning_agent_food_search_20260107.md` 파일 열기
   - 버전 업데이트 (0.3.1 → 0.4)
   - 진행 상태 체크박스 업데이트 ([x] 4단계)
   - "7. LangGraph 오케스트레이션 구조" 섹션 작성
   - "5. Tool & Capability 설계" 섹션 작성
   - 변경 이력 추가

2. **커밋**:
```bash
git add 0_document/02_planning_agent_food_search_20260107.md
git commit -m "맛집 검색 Agent 4단계 완료: Agent 오케스트레이션 및 도구 설계

- 오케스트레이션 구조: [요약]
- 주요 노드 정의
- 조건부 엣지 설계
- 도구 목록 및 사용 조건
- 기술 스택 결정"
```

3. **사용자에게 보고**:
```
4단계 완료! ✅

저장 및 커밋 완료했습니다.

다음은 5단계입니다. 계속 진행하시겠습니까?
```

---

## 🚨 주의사항

### 하지 말아야 할 것
❌ 한 번에 여러 질문
❌ 사용자 답변 전에 다음 질문
❌ 추측해서 진행 (반드시 물어보기)
❌ 복잡한 해결책 제시

### 해야 할 것
✅ 하나씩 순차적 질문
✅ 답변 후 구체화 질문
✅ 선택지 제공
✅ 정량적 기준 요청
✅ 단순한 옵션 포함

---

## 🎬 시작 신호

사용자가 다음 중 하나를 말하면 **4단계 첫 질문**을 시작하세요:
- "확인 후 이어서 진행해주세요"
- "4단계 시작"
- "다음"
- "이어서"

**첫 질문 템플릿**:
```
## 📍 4단계: Agent 오케스트레이션 및 도구 설계 (15분)

**목표**: Agent 실행 구조와 도구 생태계 설계

### Q1. Agent 오케스트레이션에 LangGraph를 사용하시나요? 아니면 다른 프레임워크를 고려 중이신가요?

참고로 현재 프로젝트는 이미 LangGraph 기반으로 일부 구현되어 있습니다 (app/agents/, app/nodes/).

사용 중이거나 계획 중인 Agent 기술 스택을 말씀해주세요.
```

